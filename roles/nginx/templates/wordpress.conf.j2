# {{ ansible_managed }}

# Prevent PHP scripts from being executed inside the uploads folder.
location ~* /wp-content/uploads/.*\.php$ {
  deny all;
}

if ($cache_uri = '') {
  set $cache_uri 'null cache';
}

location / {
  try_files
    /wp-content/cache/supercache/$http_host/$cache_uri/index-https.html
    /wp-content/cache/wp-rocket/$http_host/$cache_uri/index-https.html
    $uri
    $uri/
    /index.php?$args;
}

# EDD
# http://docs.easydigitaldownloads.com/article/682-protected-download-files-on-nginx
location ~ ^/wp-content/uploads/edd/(.*?)\.zip$ {
  rewrite / permanent;
}

# Set the max body size equal to PHP's max POST size.
client_max_body_size {{ php_post_max_size | default('25m') | lower }};

include h5bp/directive-only/x-ua-compatible.conf;
include h5bp/directive-only/extra-security.conf;
include h5bp/location/cross-domain-fonts.conf;
include h5bp/location/protect-system-files.conf;
